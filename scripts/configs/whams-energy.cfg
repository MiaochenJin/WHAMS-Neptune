# WHAMS-Neptune Configuration for Energy Reconstruction

project_name: "0122-energy-reco"
project_save_dir: "checkpoints/"
accelerator: "gpu"

data_options:
  # Using a single list of data paths.
  # The run script will handle splitting this into train/val.
  data_paths:
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/WHAMSv2/BDT/21217/*.parquet"
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/WHAMSv2/BDT/21218/*.parquet"
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/WHAMSv2/BDT/21219/*.parquet"

  val_split: 0.1          # 10% for validation
  seed: 42                # For reproducible splitting
  rescale: true           # Rescale features (coords: m->km, features: log1p)

model_options:
  downstream_task: "energy_reco"
  loss_fn: "gaussian_nll"  # Use Gaussian NLL for uncertainty estimation
  in_channels: 9           # 9 summary stats
  num_patches: 196         # Max tokens
  token_dim: 512           # Transformer dimension
  num_layers: 8            # Transformer depth
  num_heads: 8             # Attention heads (512/8 = 64 head_dim)
  hidden_dim: 2048         # FFN hidden dim (4 * token_dim)
  dropout: 0.1
  k_neighbors: 8

training_options:
  batch_size: 256
  num_workers: 4
  lr: 1e-4
  weight_decay: 0.01
  epochs: 20
  log_every_n_steps: 10
