# WHAMS-Neptune Configuration for Angular Reconstruction

project_name: "0120-dir-angular-dist-track"
project_save_dir: "checkpoints/"
accelerator: "gpu"

data_options:
  # Using a single list of data paths.
  # The run script will handle splitting this into train/val.
  # Paths are relative to where the script is run (external/WHAMS-Neptune/)
  data_paths:
    # - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/WHAMSv0/BDT/21217/*.parquet"
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/WHAMSv1/BDT/21218/*.parquet"
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/WHAMSv1/BDT/21219/*.parquet"
    # - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/WHAMSv2/BDT/22803/*.parquet"
    # - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/WHAMSv0/BDT/data_2021/*.parquet"

  val_split: 0.1          # 10% for validation
  seed: 42                # For reproducible splitting
  rescale: true            # Rescale features

model_options:
  downstream_task: "angular_reco"
  loss_fn: "angular_distance"          # Added missing loss function
  in_channels: 9          # 9 summary stats
  num_patches: 196        # Max tokens
  token_dim: 512          # Reduced from 768 for faster testing
  num_layers: 8           # Reduced from 12 for faster testing
  num_heads: 8            # Matches token_dim (512/8 = 64 head_dim)
  hidden_dim: 2048        # 4 * token_dim
  dropout: 0.1
  k_neighbors: 8

training_options:
  batch_size: 256
  num_workers: 4
  lr: 1e-4
  weight_decay: 0.01
  epochs: 20