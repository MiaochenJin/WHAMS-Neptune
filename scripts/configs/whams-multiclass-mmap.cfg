# WHAMS-Neptune Configuration for 6-Class Morphology Classification
#
# Trains Neptune to classify events into 6 morphology categories:
#   0: 0T0C  — Through-going neutrino (non-starting)
#   1: 0T1C  — Single cascade (starting)
#   2: 0TnC  — Multi-cascade (starting)
#   3: 1T0C  — Through-going with track (non-starting)
#   4: 1T1C+1TnC — Track + cascade(s) (starting, 1TnC merged due to rarity)
#   5: Background — Atmospheric muons (non-starting)
#
# Training data: multiclass-mmap (3.17M balanced events, ~15 GB)
# - Pre-balanced dataset: no weighted sampling needed
# - Classes within 1.3x of each other (443k-576k per class)

project_name: "0206_multiclass_morphology"
project_save_dir: "checkpoints"
accelerator: "gpu"

data_format: "mmap"

data_options:
  mmap_paths:
    # - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/training/multiclass-mmap/multiclass"
    - "/scratch/multiclass-mmap/multiclass"

  val_split: 0.1
  seed: 42
  rescale: true

  # Morphology mapping: raw_morph_idx -> class label
  # 1TnC (5) merged into 1T1C (4), 2TnC (6) dropped (no events)
  morphology_mapping:
    0: 0    # 0T0C -> class 0
    1: 1    # 0T1C -> class 1
    2: 2    # 0TnC -> class 2
    3: 3    # 1T0C -> class 3
    4: 4    # 1T1C -> class 4
    5: 5    # 1TnC -> class 4 (merged)
    6: 5   # 2TnC -> skip (no data)
    7: 6    # Background -> class 5

model_options:
  downstream_task: "morphology_classification"
  loss_fn: "cross_entropy"
  num_classes: 7
  in_channels: 9
  num_patches: 196
  token_dim: 512
  num_layers: 12
  num_heads: 8
  hidden_dim: 2048
  dropout: 0.1
  k_neighbors: 8

training_options:
  batch_size: 512
  num_workers: 16
  lr: 5e-5
  weight_decay: 0.01
  epochs: 30
  log_every_n_steps: 10
