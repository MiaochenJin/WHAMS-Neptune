# WHAMS-Neptune Configuration for Starting Classification with Mmap Data
#
# Uses memory-mapped training data from mmap-starting/ directory which includes:
# - NuGen 21217/18/19: All events
# - MuonGun 21315/17/18/21316_extended: 500 files each (background)
# - SIREN charms/inclusive: Starting events only
# - NuGen 22663: Starting events only (high-energy upgoing)

project_name: "0130-mmap-starting"
project_save_dir: "checkpoints"
accelerator: "gpu"

# Use mmap data format instead of parquet
data_format: "mmap"

data_options:
  # Mmap file paths (without .idx/.dat extension)
  mmap_paths:
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/training/mmap-starting/nugen_21217"
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/training/mmap-starting/nugen_21218"
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/training/mmap-starting/nugen_21219"
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/training/mmap-starting/muongun_21315"
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/training/mmap-starting/muongun_21317"
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/training/mmap-starting/muongun_21318"
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/training/mmap-starting/muongun_21316_extended"
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/training/mmap-starting/siren_charms_starting"
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/training/mmap-starting/siren_inclusive_starting"
    - "/n/holylfs05/LABS/arguelles_delgado_lab/Everyone/miaochenjin/WHA-MS/datafiles/training/mmap-starting/nugen_22663_starting"

  val_split: 0.1          # 10% for validation
  seed: 42                # For reproducible splitting
  rescale: true           # Rescale features

  # Note: morphology_mapping not needed for mmap - labels are pre-computed
  # The mmap format stores starting=1/0 directly

model_options:
  downstream_task: "morphology_classification"
  loss_fn: "binary_cross_entropy"
  num_classes: 2          # Binary classification: Starting(1) vs Background(0)
  in_channels: 9          # 9 summary stats
  num_patches: 196
  token_dim: 512
  num_layers: 12
  num_heads: 8
  hidden_dim: 2048
  dropout: 0.1
  k_neighbors: 8

training_options:
  batch_size: 128
  num_workers: 16
  lr: 5e-5
  weight_decay: 0.01
  epochs: 30
  log_every_n_steps: 10
